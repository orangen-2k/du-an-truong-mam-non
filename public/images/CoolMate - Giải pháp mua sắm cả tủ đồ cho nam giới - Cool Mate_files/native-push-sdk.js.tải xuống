!function(e){var t={};function i(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(r,s,function(t){return e[t]}.bind(null,s));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=251)}({251:function(e,t){function i(){this.partnerName=Insider.partner.name,this.storageName="insdrSubsId",this.debug=!0,this.tokenCollectorUrl="https://web-push-token-collector.api.useinsider.com/",this.hitApiUrl="https://hit.api.useinsider.com/hit",this.swPath=Insider.webPushState.nativeOptInSDKCustomPath?Insider.webPushState.nativeOptInSDKCustomPath:"/insider-sw-sdk.js",this.VAPIDPublicKey=Insider.webPushState.VAPIDPublicKey,this.isVAPIDActive=!Insider.fns.isEmptyString(this.VAPIDPublicKey),this.storageAuth="insdrAuth",this.storageDH="insdrDH",this.storagePayloadComplete="insdrPayloadComplete",this.storageSubscriptionCreateDate="insdrSubsIdCreateDate",this.storageIsVAPID="isVAPID",this.registeredWorkerPath="migratedSDK",this.cookies={},this.DBName="INSIDER_WEB_PUSH_DB",this.tableName="settings",this.hasServiceWorkerSupport="serviceWorker"in navigator,this.hasPush="PushManager"in window||"push"in navigator,this.events={CORE:"nativeSdk:permission:",PROMPTED:"prompted",GRANTED:"granted",DENIED:"denied"}}i.prototype.initialize=function(){return Insider.worker.pm({type:"initializePushStateCookies",success:function(e){this.cookies=e,this.debug=this.checkFromStorage("insider-push-debug","true"),this.initializeIndexedDB(function(e){e&&(Insider.indexedDB.save(this.tableName,{id:1,name:"partnerName",value:this.partnerName}),Insider.indexedDB.save(this.tableName,{id:2,name:"spUID",value:Insider.getUserId()}),Insider.indexedDB.save(this.tableName,{id:3,name:"lastReceivedWebPushes",value:[]}))}.bind(this)),this.debug&&(console.log("Initializing Native SDK"),console.log("Push Manager Support:",this.hasPush)),this.hasPush&&(this.saveImpressionLog(),this.storeRegisterRequest(),this.grantPermission())}.bind(this)}),Insider.eventManager.dispatch(this.events.CORE+this.events.PROMPTED),!0},i.prototype.initializeIndexedDB=function(e){return Insider.indexedDB.connect(this.DBName,this.tableName,(function(t){e(t)})),!0},i.prototype.saveImpressionLog=function(){return!this.checkFromStorage("native-permission-impression","true")&&(this.addToStorage("native-permission-impression","true",360),new Insider.log("w",{t:"storeLog",type:"webPush",logType:"native-permission-impression",browser:Insider.browser.name,isMobile:Insider.browser.isMobile(),userID:Insider.getUserId()}).send(),!0)},i.prototype.storeRegisterRequest=function(){return!this.checkFromStorage("push-request-sent","true")&&(new Insider.log("w",{t:"storeLog",type:"webPush",logType:"push-request",browser:Insider.browser.name,isMobile:Insider.browser.isMobile(),userID:Insider.getUserId()}).send(),!0)},i.prototype.grantPermission=function(){return this.appendOverlay(),Notification.requestPermission().then(this.handlePermissionAction.bind(this)),!0},i.prototype.appendOverlay=function(){if(!window.insiderOptInOverlayIsActive)return!1;var e=Insider.dom().create("div",{id:"insider-opt-in-native-dialog"});return e.append(Insider.dom().create("div",{className:"insider-opt-in-overlay"})),e.append(Insider.dom().create("div",{className:"insider-opt-in-overlay-message"}).text(window.insiderOptInOverlayMessage)),Insider.dom("body").append(e),window.insiderOverlayCloseOnClick&&Insider.eventManager.on("click",".insider-opt-in-overlay",this.removeOverlay.bind(this)),!0},i.prototype.handlePermissionAction=function(e){return this.removeOverlay(),"granted"!==e?(Insider.eventManager.dispatch(this.events.CORE+this.events.DENIED),!1):(Insider.eventManager.dispatch(this.events.CORE+this.events.GRANTED),this.registerServiceWorker(),!0)},i.prototype.removeOverlay=function(){return!!window.insiderOptInOverlayIsActive&&(Insider.dom("#insider-opt-in-native-dialog").remove(),!0)},i.prototype.registerServiceWorker=function(){return navigator.serviceWorker.register(this.swPath).then(this.handleRegistrationEvent.bind(this)).catch(this.handleException.bind(this)),Insider.worker.pm({type:"unregisterCustomOptInServiceWorker"}),!0},i.prototype.handleException=function(e){var t=Number(Insider.webPushState.nativeOptInCookieSettings.permissionAbandonExpireDay);return"denied"===Notification.permission&&(t=Number(Insider.webPushState.nativeOptInCookieSettings.permissionBlockExpireDay)),this.setUserPermissionGranted({pushRequestSent:!0}),this.addToStorage("push-request-sent","true",t),this.debug&&console.log(e),this.removeOverlay(),!0},i.prototype.handleRegistrationEvent=function(e){return e.addEventListener("updatefound",function(t){var i=t.target.installing;i.addEventListener("statechange",function(){"activated"===i.state&&this.subscribe(e)}.bind(this))}.bind(this)),this.instantSubscribe(e),!0},i.prototype.subscribe=function(e){var t={userVisibleOnly:!0};return this.isVAPIDActive&&(t.applicationServerKey=this.convertVapidKeyToInt8Array(),this.addToStorage(this.storageIsVAPID,"true",360)),e.pushManager.subscribe(t).then(this.saveSubscription.bind(this)).catch((function(e){console.log("Error occurred while subscribing existing registration: ",e),Insider.fns.has(e.message,"applicationServerKey")&&this.hasServiceWorkerSupport&&navigator.serviceWorker.getRegistration().then(function(e){Insider.fns.isUndefined(e)||e.unregister().then(function(){this.register()}.bind(this))}.bind(this))})),!0},i.prototype.saveSubscription=function(e){var t;t="subscriptionId"in e?e.subscriptionId:this.getSubscriptionId(e.endpoint);var i=Insider.fns.parse(Insider.fns.stringify(e)).keys||{},r=i.auth||"",s=i.p256dh||"";return this.setUserPermissionGranted({insdrSubsId:t,pushRequestSent:!0}),this.migrationNeeded()||Insider.webPushState.hasOptedInBefore?this.saveSubscriptionId(t,r,s,"update"):this.saveSubscriptionId(t,r,s,"insert"),!0},i.prototype.saveSubscriptionId=function(e,t,i,r){return this.sendRequest(this.tokenCollectorUrl,Insider.fns.stringify({token:e,authToken:t,p256DH:i,isNativeOptIn:1,createDate:(new Date).getTime(),browser:Insider.browser.getBrowserNameForWebPushToken(),userId:Insider.getUserId(),pageUrl:window.location.href,language:Insider.systemRules.call("getLang"),partnerName:this.partnerName,method:r,isVAPIDActive:this.isVAPIDActive}),function(){var r=Number(Insider.webPushState.nativeOptInCookieSettings.permissionAllowExpireDay);this.addToStorage("push-request-sent","true",r),this.addToStorage(this.storagePayloadComplete,"true",r),this.addToStorage(this.storageAuth,t,r),this.addToStorage(this.storageDH,i,r),this.addToStorage(this.storageName,e,r),this.addToStorage(this.registeredWorkerPath,this.swPath,r),this.addToStorage(this.storageSubscriptionCreateDate,(new Date).getTime(),r)}.bind(this)),this.sendRequest(this.hitApiUrl,Insider.fns.encode(Insider.fns.stringify({version:"1.0",partner_name:this.partnerName,user_id:Insider.getUserId(),event:"user",webpush_optin:!0,webpush_token:e,webpush_language:Insider.systemRules.call("getLang"),device_type:Insider.browser.getDeviceType()}))),!0},i.prototype.setUserPermissionGranted=function(e){return Insider.fns.pm({target:window.top,type:"setUserPermissionGranted",message:e}),!0},i.prototype.getSubscriptionId=function(e){return e.split("/").pop()},i.prototype.instantSubscribe=function(e){var t;return e.installing?t=e.installing:e.waiting?t=e.waiting:e.active&&(t=e.active),!(!t||"activated"!==t.state)&&(this.subscribe(e),!0)},i.prototype.migrationNeeded=function(){var e=this.checkFromStorage(this.storagePayloadComplete,"true"),t=Insider.webPushState.nativeOptInSDKCustomPath&&!Insider.storage.get("migratedSDK","cookie",!0)&&e,i=!e&&this.getCookie(this.storageName);return t||i},i.prototype.setCookieOnWorker=function(e,t,i){return Insider.worker.pm({type:"setCookie",message:{name:e,value:t,options:{path:"/",expires:i,domain:this.partnerName+".api.useinsider.com"}}}),!0},i.prototype.getCookie=function(e){return this.cookies[e]},i.prototype.addToStorage=function(e,t,i){return this.checkFromStorage(e,t)?(this.removeStorage(e),!1):(this.setCookieOnWorker(e,t,i),!0)},i.prototype.removeStorage=function(e){return!!this.getCookie(e)&&(this.setCookieOnWorker(e,"",-1),!0)},i.prototype.checkFromStorage=function(e,t){return this.getCookie(e)==t},i.prototype.convertVapidKeyToInt8Array=function(){for(var e=this.VAPIDPublicKey,t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),i=window.atob(t),r=new Uint8Array(i.length),s=0;s<i.length;++s)r[s]=i.charCodeAt(s);return r},i.prototype.sendRequest=function(e,t,i){return Insider.request.post({url:e,data:t,success:function(){(i||Insider.fns.noop)()},error:function(e,t){this.debug&&console.log(t),this.handleException(t)}.bind(this)}),!0},(new i).initialize()}});